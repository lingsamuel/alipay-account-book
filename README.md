# Simple Alipay Account Book Statistics

简单的支付宝账单统计脚本。

原本用于避免账单包含各种转账记录，导致算出来的花费总量奇大无比；以及计算某一类花销。

# 使用说明

## 获取支付宝账单

点击这个链接：[支付宝-我的账单](https://consumeprod.alipay.com/record/standard.htm) ([https://consumeprod.alipay.com/record/standard.htm](https://consumeprod.alipay.com/record/standard.htm))，
页面会要求你扫码，然后跳转到主页，再点一次这个链接就能进去了。正常入口有点难找，懒得讲了。

页面底部会有一个下载，下载下来后会有一个 `.csv` 格式的文件，
注意，请 **把它的开头结尾部分不符合 CSV 格式的部分删除**。最好转成 UTF-8 格式（默认为 GB 2312）。

## 配置 config.json

`config.json` 形如如下代码段：

```json
{
  "dataPath": "C:\\Users\\Whoever\\Wherever\\data.csv",
  "matchers": [
    ["余额宝收益", "交易对方", ["天弘基金管理有限公司"], "AND", "商品名称", ["收益发放"]],

    ["收入", "资金状态", ["已收入"]],
    ["花呗", "交易对方", ["花呗", "备用金"]],

    ["交通", "交易对方", ["滴滴出行", "小桔科技", "携程", "Trip com", "航空", "旅行"]],

    ["淘宝", "交易来源地", ["淘宝"]],

    ["转账", "商品名称", ["转账", "收款", "转入", "转出", "红包奖励发放", "提现"], "OR", "资金状态", ["资金转移"]]
  ]
}
```

`dataPath` 处改成你下载到的 `.csv` 文件的实际路径，这个文件夹也将作为统计后的数据保存的地方。

## 匹配器 matchers 含义

```json
["余额宝收益", "交易对方", ["天弘基金管理有限公司"], "AND", "商品名称", ["收益发放"]]
```

符合条件的条目会被放入 `余额宝收益.csv` 文件里。

条件是：
- 这个条目的 `交易对方` 字段，包含数组 `["天弘基金管理有限公司"]` 的某一个元素，
- 并且（`AND`）
- 它的 `商品名称` 字段，要包含数组 `["收益发放"]` 的某一个元素。

不区分大小写。

因此这个匹配器将正确地匹配余额宝的收益，而不会统计转入、转出。

### OR 匹配器

```json
["转账", "商品名称", ["转账", "收款", "转入", "转出", "红包奖励发放", "提现"], "OR", "资金状态", ["资金转移"]]
```

等效于

```json
["转账", "商品名称", ["转账", "收款", "转入", "转出", "红包奖励发放", "提现"]],
["转账", "资金状态", ["资金转移"]]
```

# For Developer

打包 exe:

```shell
npm run build
```

## 特殊规则

花呗的还款实际上是重复的，因此它没有 `收/支` 这个字段的值。
